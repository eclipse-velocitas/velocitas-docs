<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Velocitas – Vehicle Abstraction Layer (VAL)</title>
    <link>/velocitas-docs/docs/reference/val/</link>
    <description>Recent content in Vehicle Abstraction Layer (VAL) on Velocitas</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Mon, 09 May 2022 14:24:56 +0530</lastBuildDate>
    
	  <atom:link href="/velocitas-docs/docs/reference/val/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: Interface Design Guideline</title>
      <link>/velocitas-docs/docs/reference/val/interface_guideline/</link>
      <pubDate>Mon, 09 May 2022 14:24:56 +0530</pubDate>
      
      <guid>/velocitas-docs/docs/reference/val/interface_guideline/</guid>
      <description>
        
        
        &lt;h2 id=&#34;grpc-interface-style-guide&#34;&gt;GRPC Interface Style Guide&lt;/h2&gt;
&lt;p&gt;This document provides a style guide for .proto files. By following these conventions, you&amp;rsquo;ll make your protocol buffer message definitions and their corresponding classes consistent and easy to read.
Unless otherwise indicated, this style guide is based on the style guide from &lt;a href=&#34;https://developers.google.com/protocol-buffers/docs/style&#34;&gt;google protocol-buffers style&lt;/a&gt; under Apache 2.0 License &amp;amp; Creative Commons Attribution 4.0 License.&lt;/p&gt;
&lt;p&gt;Note that protocol buffer style can evolve over time, so it is likely that you will see .proto files written in different conventions or styles. Please respect the existing style when you modify these files. Consistency is key. However, it is best to adopt the current best style when you are creating a new .proto file.&lt;/p&gt;
&lt;h3 id=&#34;standard-file-formatting&#34;&gt;Standard file formatting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Keep the line length to 80 characters.&lt;/li&gt;
&lt;li&gt;Use an indent of 2 spaces.&lt;/li&gt;
&lt;li&gt;Prefer the use of double quotes for strings.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;file-structure&#34;&gt;File structure&lt;/h3&gt;
&lt;p&gt;Files should be named lower_snake_case.proto&lt;/p&gt;
&lt;p&gt;All files should be ordered in the following manner:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;License header&lt;/li&gt;
&lt;li&gt;File overview&lt;/li&gt;
&lt;li&gt;Syntax&lt;/li&gt;
&lt;li&gt;Package&lt;/li&gt;
&lt;li&gt;Imports (sorted)&lt;/li&gt;
&lt;li&gt;File options&lt;/li&gt;
&lt;li&gt;Everything else&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;directory-structure&#34;&gt;Directory Structure&lt;/h3&gt;
&lt;p&gt;Files should be stored in a directory structure that matches their package sub-names. All files
in a given directory should be in the same package.
Below is an example based on the &lt;a href=&#34;https://github.com/eclipse/kuksa.val/tree/master/kuksa_databroker/proto&#34;&gt;proto files&lt;/a&gt; in the kuksa.val repository.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   proto/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   └── sdv
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|       └── databroker
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|           └── v1                  // package sdv.databroker.broker.v1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|               ├── broker.proto    // service Broker in sdv.databroker.broker.v1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|               ├── collector.proto // service Collector in sdv.databroker.broker.v1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|               └── types.proto     // type definition and import of  in sdv.databroker.broker.v1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The proposed structure shown above is adapted from &lt;a href=&#34;https://raw.githubusercontent.com/uber/prototool/dev/style/README.md&#34;&gt;Uber Protobuf Style Guide V2&lt;/a&gt; under MIT License.&lt;/p&gt;
&lt;h3 id=&#34;packages&#34;&gt;Packages&lt;/h3&gt;
&lt;p&gt;Package names should be in lowercase. Package names should have unique names based on the project name, and possibly based on the path of the file containing the protocol buffer type definitions.&lt;/p&gt;
&lt;h3 id=&#34;message-and-field-names&#34;&gt;Message and field names&lt;/h3&gt;
&lt;p&gt;Use PascalCase (CamelCase with an initial capital) for message names – for example, SongServerRequest. Use underscore_separated_names for field names (including oneof field and extension names) – for example, song_name.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;message SongServerRequest {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   optional string song_name = 1;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Using this naming convention for field names gives you accessors like the following:&lt;/p&gt;
&lt;p&gt;C++:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;song_name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;...&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;set_song_name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;x&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;...&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If your field name contains a number, the number should appear after the letter instead of after the underscore. For example, use song_name1 instead of song_name_1
Repeated fields&lt;/p&gt;
&lt;p&gt;Use pluralized names for repeated fields.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;repeated&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;keys&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;;&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;repeated&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;MyMessage&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;accounts&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;17&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;;&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;enums&#34;&gt;Enums&lt;/h3&gt;
&lt;p&gt;Use PascalCase (with an initial capital) for enum type names and CAPITALS_WITH_UNDERSCORES for value names:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;FooBar&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#000&#34;&gt;FOO_BAR_UNSPECIFIED&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#000&#34;&gt;FOO_BAR_FIRST_VALUE&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#000&#34;&gt;FOO_BAR_SECOND_VALUE&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Each enum value should end with a semicolon, not a comma. The zero value enum should have the suffix UNSPECIFIED.&lt;/p&gt;
&lt;p&gt;###Services&lt;/p&gt;
&lt;p&gt;If your .proto defines an RPC service, you should use PascalCase (with an initial capital) for both the service name and any RPC method names:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;service&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;FooService&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;rpc&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;GetSomething&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;GetSomethingRequest&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;returns&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;GetSomethingResponse&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;);&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;rpc&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ListSomething&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ListSomethingRequest&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;returns&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ListSomethingResponse&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;);&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;grpc-interface-versioning&#34;&gt;GRPC Interface Versioning&lt;/h3&gt;
&lt;p&gt;All API interfaces must provide a major version number, which is encoded at the end of the protobuf package.
If an API introduces a breaking change, such as removing or renaming a field, it must increment its API version number to ensure that existing user code does not suddenly break.
Note: The use of the term &amp;ldquo;major version number&amp;rdquo; above is taken from semantic versioning. However, unlike in traditional semantic versioning, APIs must not expose minor or patch version numbers.
For example, APIs use v1, not v1.0, v1.1, or v1.4.2. From a user&amp;rsquo;s perspective, minor versions are updated in place, and users receive new functionality without migration.&lt;/p&gt;
&lt;p&gt;A new major version of an API must not depend on a previous major version of the same API. An API may depend on other APIs, with an expectation that the caller understands the dependency and stability risk associated with those APIs. In this scenario, a stable API version must only depend on stable versions of other APIs.&lt;/p&gt;
&lt;p&gt;Different versions of the same API should preferably be able to work at the same time within a single client application for a reasonable transition period. This time period allows the client to transition smoothly to the newer version. An older version must go through a reasonable, well-communicated deprecation period before being shut down.&lt;/p&gt;
&lt;p&gt;For releases that have alpha or beta stability, APIs must append the stability level after the major version number in the protobuf package.&lt;/p&gt;
&lt;h4 id=&#34;release-based-versioning&#34;&gt;Release-based versioning&lt;/h4&gt;
&lt;p&gt;An individual release is an alpha or beta release that is expected to be available for a limited time period before its functionality is incorporated into the stable channel, after which the individual release will be shut down.
When using release-based versioning strategy, an API may have any number of individual releases at each stability level.&lt;/p&gt;
&lt;p&gt;Alpha and beta releases must have their stability level appended to the version, followed by an incrementing release number. For example, v1beta1 or v1alpha5. APIs should document the chronological order of these versions in their documentation (such as comments).
Each alpha or beta release may be updated in place with backwards-compatible changes. For beta releases, backwards-incompatible updates should be made by incrementing the release number and publishing a new release with the change. For example, if the current version is v1beta1, then v1beta2 is released next.&lt;/p&gt;
&lt;p&gt;Adapted from &lt;a href=&#34;https://cloud.google.com/apis/design/versioning?hl=en#release-based_versioning&#34;&gt;google release-based_versioning&lt;/a&gt; under Apache 2.0 License &amp;amp; Creative Commons Attribution 4.0 License&lt;/p&gt;
&lt;h3 id=&#34;backwards-compatibility&#34;&gt;Backwards compatibility&lt;/h3&gt;
&lt;p&gt;The gRPC protocol is designed to support services that change over time. Generally, additions to gRPC services and methods are non-breaking. Non-breaking changes allow existing clients to continue working without changes. Changing or deleting gRPC services are breaking changes. When gRPC services have breaking changes, clients using that service have to be updated and redeployed.&lt;/p&gt;
&lt;p&gt;Making non-breaking changes to a service has a number of benefits:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Existing clients continue to run.&lt;/li&gt;
&lt;li&gt;Avoids work involved with notifying clients of breaking changes, and updating them.&lt;/li&gt;
&lt;li&gt;Only one version of the service needs to be documented and maintained.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;non-breaking-changes&#34;&gt;Non-breaking changes&lt;/h3&gt;
&lt;p&gt;These changes are non-breaking at a gRPC protocol level and binary level.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Adding a new service&lt;/li&gt;
&lt;li&gt;Adding a new method to a service&lt;/li&gt;
&lt;li&gt;Adding a field to a request message - Fields added to a request message are deserialized with the default value on the server when not set. To be a non-breaking change, the service must succeed when the new field isn&amp;rsquo;t set by older clients.&lt;/li&gt;
&lt;li&gt;Adding a field to a response message - Fields added to a response message are deserialized into the message&amp;rsquo;s unknown fields collection on the client.&lt;/li&gt;
&lt;li&gt;Adding a value to an enum - Enums are serialized as a numeric value. New enum values are deserialized on the client to the enum value without an enum name. To be a non-breaking change, older clients must run correctly when receiving the new enum value.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;binary-breaking-changes&#34;&gt;Binary breaking changes&lt;/h3&gt;
&lt;p&gt;The following changes are non-breaking at a gRPC protocol level, but the client needs to be updated if it upgrades to the latest .proto contract. Binary compatibility is important if you plan to publish a gRPC library.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Removing a field - Values from a removed field are deserialized to a message&amp;rsquo;s unknown fields. This isn&amp;rsquo;t a gRPC protocol breaking change, but the client needs to be updated if it upgrades to the latest contract. It&amp;rsquo;s important that a removed field number isn&amp;rsquo;t accidentally reused in the future. To ensure this doesn&amp;rsquo;t happen, specify deleted field numbers and names on the message using Protobuf&amp;rsquo;s reserved keyword.&lt;/li&gt;
&lt;li&gt;Renaming a message - Message names aren&amp;rsquo;t typically sent on the network, so this isn&amp;rsquo;t a gRPC protocol breaking change. The client will need to be updated if it upgrades to the latest contract. One situation where message names are sent on the network is with Any fields, when the message name is used to identify the message type.&lt;/li&gt;
&lt;li&gt;Nesting or unnesting a message - Message types can be nested. Nesting or unnesting a message changes its message name. Changing how a message type is nested has the same impact on compatibility as renaming.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;protocol-breaking-changes&#34;&gt;Protocol breaking changes&lt;/h3&gt;
&lt;p&gt;The following items are protocol and binary breaking changes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Renaming a field - With Protobuf content, the field names are only used in generated code. The field number is used to identify fields on the network. Renaming a field isn&amp;rsquo;t a protocol breaking change for Protobuf. However, if a server is using JSON content, then renaming a field is a breaking change.&lt;/li&gt;
&lt;li&gt;Changing a field data type - Changing a field&amp;rsquo;s data type to an incompatible type will cause errors when deserializing the message. Even if the new data type is compatible, it&amp;rsquo;s likely the client needs to be updated to support the new type if it upgrades to the latest contract.&lt;/li&gt;
&lt;li&gt;Changing a field number - With Protobuf payloads, the field number is used to identify fields on the network.&lt;/li&gt;
&lt;li&gt;Renaming a package, service or method - gRPC uses the package name, service name, and method name to build the URL. The client gets an UNIMPLEMENTED status from the server.&lt;/li&gt;
&lt;li&gt;Removing a service or method - The client gets an UNIMPLEMENTED status from the server when calling the removed method.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;behavior-breaking-changes&#34;&gt;Behavior breaking changes&lt;/h3&gt;
&lt;p&gt;When making non-breaking changes, you must also consider whether older clients can continue working with the new service behavior. For example, adding a new field to a request message:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Isn&amp;rsquo;t a protocol breaking change.&lt;/li&gt;
&lt;li&gt;Returning an error status on the server if the new field isn&amp;rsquo;t set makes it a breaking change for old clients.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Behavior compatibility is determined by your app-specific code.&lt;/p&gt;
&lt;p&gt;Adapted from &lt;a href=&#34;https://docs.microsoft.com/en-us/aspnet/core/grpc/versioning?view=aspnetcore-6.0&#34;&gt;Versioning gRPC services&lt;/a&gt; under Creative Commons Attribution 4.0 License&lt;/p&gt;
&lt;h2 id=&#34;error-handling&#34;&gt;Error Handling&lt;/h2&gt;
&lt;h3 id=&#34;grpc-error-handling&#34;&gt;gRPC error handling&lt;/h3&gt;
&lt;p&gt;In gRPC, a large set of error codes has been &lt;a href=&#34;https://grpc.github.io/grpc/cpp/md_doc_statuscodes.html&#34;&gt;defined&lt;/a&gt;
As a general rule, SDV should use relevant gRPC error codes,
as described in &lt;a href=&#34;https://stackoverflow.com/questions/59094839/whats-the-correct-way-to-return-a-not-found-response-from-a-grpc-c-server-i&#34;&gt;this thread&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Status&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;StatusCode&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NOT_FOUND&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;error details here&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Available constructor:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Status&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Status&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;StatusCode&lt;/span&gt;  &lt;span style=&#34;color:#000&#34;&gt;code&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;std&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;error_message&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;std&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;error_details&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The framework for drafting error messages could be useful as a later improvement. This could e.g., be used to specify which unit created the error message and to assure the same structure on all messages. The latter two may e.g., depend on debug settings, e.g., error details only in debug-builds to avoid leaks of sensitive information. A global function like below or similar could handle that and also possibly convert between internal error codes and gRPC codes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Status&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;status&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;CreateStatusMessage&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;PERMISSION_DENIED&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;DataBroker&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Rule access rights violated&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;vsc-error-handling&#34;&gt;VSC error handling&lt;/h3&gt;
&lt;p&gt;VSC recently added errors to the &lt;a href=&#34;https://github.com/COVESA/vehicle_service_catalog/blob/master/comfort-service.yml&#34;&gt;example service&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   methods:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      - name: move
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        description: |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          Set the desired seat position
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        in:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          - name: seat
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            description: |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              The desired seat position
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            datatype: seat_t
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        error:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          datatype: .stdvsc.error_t
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          range: $ in_set(&amp;#34;ok&amp;#34;, &amp;#34;completed&amp;#34;, &amp;#34;in_progress&amp;#34;, &amp;#34;interrupted&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The errors come from a &lt;a href=&#34;https://github.com/COVESA/vehicle_service_catalog/blob/master/vsc-error.yml&#34;&gt;standardized error list&lt;/a&gt;,
and for each method in VSC, a range clause can be used to specify which errors from that list that are applicable.&lt;/p&gt;
&lt;p&gt;It is in VSC explicitly &lt;a href=&#34;https://github.com/COVESA/vehicle_service_catalog#methods-list-object-error&#34;&gt;specified&lt;/a&gt; that:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Transport-layer issues arising from interrupted communication, services going down, etc, are handled on a language-binding level where each language library implements its own way of detecting, reporting, and recovering from network-related errors.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This means that VSC error messages intentionally cover a smaller subset than gRPC error messages. Unlike gRPC,
there is currently no detailed documentation in VCS on when individual error codes shall be used, which could cause
problems as some error codes are similar.&lt;/p&gt;
&lt;h3 id=&#34;sdv-error-handling-for-grpc-interfaces-eg-val-vehicles-services&#34;&gt;SDV error handling for gRPC interfaces (e.g., VAL vehicles services)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Use gRPC error codes as base&lt;/li&gt;
&lt;li&gt;Document in proto files (as comments) which error codes that the service implementation can emit and the meaning of them. (Errors that only are emitted by the gRPC framework do not need to be listed.)&lt;/li&gt;
&lt;li&gt;Do not - unless there are special reasons - add explicit error/status fields to rpc return messages.&lt;/li&gt;
&lt;li&gt;Additional error information can be given by free text fields in gRPC error codes. Note, however, that sensitive information like &lt;code&gt;Given password ABCD does not match expected password EFGH&lt;/code&gt; should not be passed in an unprotected/unencrypted manner.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sdv-handling-of-grpc-error-codes&#34;&gt;SDV handling of gRPC error codes&lt;/h3&gt;
&lt;p&gt;The table below gives error code guidelines for each gRPC on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If it is relevant for a client to retry the call or not when receiving the error code. Retry is only relevant if the error is of a temporary nature.&lt;/li&gt;
&lt;li&gt;Which VSC error code matches the respective gRPC error code&lt;/li&gt;
&lt;li&gt;When to use the error code when implementing a service.&lt;/li&gt;
&lt;/ul&gt;
&lt;table border=&#34;1&#34;&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;gRPC error code&lt;/th&gt;
      &lt;th&gt;Retry Relevant?&lt;/th&gt;
      &lt;th&gt;Corresponding VSC error codes&lt;/th&gt;
      &lt;th&gt;Recommended SDV usage&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;OK&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;ok, completed, in_progress&lt;/td&gt;
      &lt;td&gt;Mandatory error code if operation succeeded. Shall never be used if operation failed.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;CANCELLED&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;interrupted&lt;/td&gt;
      &lt;td&gt;No explicit use case on server side in SDV identified&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;UNKNOWN&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;other&lt;/td&gt;
      &lt;td&gt;To be used in default-statements when converting errors from e.g., Broker-errors to SDV/gRPC errors&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;INVALID_ARGUMENT&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;invalid_argument&lt;/td&gt;
      &lt;td&gt;E.g., Rule syntax with errors&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DEADLINE_EXCEEDED&lt;/td&gt;
      &lt;td&gt;Yes&lt;/td&gt;
      &lt;td&gt;expired&lt;/td&gt;
      &lt;td&gt;Only applicable for asynchronous services, i.e. services which wait for completion before the result is returned. The behavior if a VSC operation cannot finish within expected time must be defined. Two options exist. One is to return this error after e.g., X seconds. Another is that the server never gives up, but rather waits for the client to cancel the operation.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;NOT_FOUND&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;not_found&lt;/td&gt;
      &lt;td&gt;Long term situation that likely not will change in the near future. &lt;br/&gt; Example: SDV can not find the specified resource (e.g., no path to get data for specified seat) &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ALREADY_EXISTS&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;other&lt;/td&gt;
      &lt;td&gt;No explicit use case on server side in SDV identified&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PERMISSION_DENIED&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;permission_denied&lt;/td&gt;
      &lt;td&gt;Operation rejected due to permission denied&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;RESOURCE_EXHAUSTED&lt;/td&gt;
      &lt;td&gt;Yes&lt;/td&gt;
      &lt;td&gt;no_resource, busy&lt;/td&gt;
      &lt;td&gt;Possibly if e.g., malloc fails or similar errors.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;FAILED_PRECONDITION&lt;/td&gt;
      &lt;td&gt;Yes&lt;/td&gt;
      &lt;td&gt;incorrect_state&lt;/td&gt;
      &lt;td&gt;Could be returned if e.g., operation is rejected due to safety reasons. (E.g., vehicle moving)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ABORTED&lt;/td&gt;
      &lt;td&gt;Yes&lt;/td&gt;
      &lt;td&gt;lost_arbitration&lt;/td&gt;
      &lt;td&gt;Could e.g., be returned if service does not support concurrent requests, and there is already either a related operation ongoing or the operation is aborted due to a newer request received. Could also be used if an operation is aborted on user/driver request, e.g., physical button in vehicle pressed.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;OUT_OF_RANGE&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;invalid_argument&lt;/td&gt;
      &lt;td&gt;E.g., Arguments out of range&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;UNIMPLEMENTED&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;not_supported&lt;/td&gt;
      &lt;td&gt;To be used if certain use-cases of the service are not implemented, e.g., if recline cannot be adjusted&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;INTERNAL&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;other&lt;/td&gt;
      &lt;td&gt;Internal errors, like exceptions, unexpected null pointers and similar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;UNAVAILABLE&lt;/td&gt;
      &lt;td&gt;Yes&lt;/td&gt;
      &lt;td&gt;no_service&lt;/td&gt;
      &lt;td&gt;To be used if the service is temporarily unavailable, e.g., during system startup.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DATA_LOSS&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;other&lt;/td&gt;
      &lt;td&gt;No explicit use case identified on server side in SDV. Out of scope of VSC.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;UNAUTHENTICATED&lt;/td&gt;
      &lt;td&gt;No&lt;/td&gt;
      &lt;td&gt;other&lt;/td&gt;
      &lt;td&gt;No explicit use case identified on server side in SDV. Out of scope of VSC.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;N/A&lt;/td&gt;
      &lt;td&gt;N/A&lt;/td&gt;
      &lt;td&gt;null&lt;/td&gt;
      &lt;td&gt;VSC error not applicable if using gRPC as gRPC always return an error code&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;As can be seen in the table above, there is not always a 1:1 mapping between VSC errors and gRPC errors.
Parts of this need to be sorted out in VSC context, e.g., difference between &lt;code&gt;ok&lt;/code&gt; and &lt;code&gt;completed&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;proposed-handling-when-implementing-service-defined-in-vsc&#34;&gt;Proposed handling when implementing service defined in VSC&lt;/h3&gt;
&lt;p&gt;The starting approach when implementing a service defined in VSC in a framework using gRPC errors is to only use gRPC errors that correspond to defined VSC errors.
If a VSC method e.g., specifies only &lt;code&gt;ok&lt;/code&gt; and &lt;code&gt;incorrect_state&lt;/code&gt; as error codes,
then an implementation using gRPC shall, if possible, only use the gRPC error codes &lt;code&gt;OK&lt;/code&gt; and &lt;code&gt;FAILED_PRECONDITION&lt;/code&gt;.
If additional gRPC errors are relevant, then it shall be investigated whether or not the specified VSC list of errors can be extended.&lt;/p&gt;
&lt;h3 id=&#34;comparison-on-actual-error-code-usage&#34;&gt;Comparison on actual error code usage&lt;/h3&gt;
&lt;p&gt;The current list of error codes in &lt;a href=&#34;https://github.com/COVESA/vehicle_service_catalog/blob/master/comfort-service.yml&#34;&gt;VSC&lt;/a&gt;
does not cover all error messages that SDV can return. Extensions are needed, but can be covered by
existing VSC error codes.
The existing VSC definitions shall preferably be extended with comments so that the meaning of the different error codes in this particular context are clarified.&lt;/p&gt;
&lt;table border=&#34;1&#34;&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;VSC Method&lt;/th&gt;
      &lt;th&gt;Currently defined VSC errors&lt;/th&gt;
      &lt;th&gt;Used gRPC errors&lt;/th&gt;
      &lt;th&gt;Proposed VSC changes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;move&lt;/td&gt;
      &lt;td&gt;&#34;ok&#34;, &#34;completed&#34;, &#34;in_progress&#34;, &#34;interrupted&#34;&lt;/td&gt;
      &lt;td&gt;OK, OUT_OF_RANGE, INVALID_ARGUMENT, INTERNAL&lt;/td&gt;
      &lt;td&gt;Add invalid_argument, other. Difference between ok and completed to be clarified. When/how is in_progress to be used? Possibly add &#34;not_found&#34; as used by other methods.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;move_component&lt;/td&gt;
      &lt;td&gt;&#34;ok&#34;, &#34;not_found&#34;, &#34;busy&#34;&lt;/td&gt;
      &lt;td&gt;OK, OUT_OF_RANGE, NOT_FOUND, INVALID_ARGUMENT, INTERNAL&lt;/td&gt;
      &lt;td&gt;Add invalid_argument, other. &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;current_position&lt;/td&gt;
      &lt;td&gt;&#34;ok&#34;, &#34;not_found&#34;&lt;/td&gt;
      &lt;td&gt;OK, OUT_OF_RANGE&lt;/td&gt;
      &lt;td&gt;Add invalid_argument, check VSC difference between not_found and invalid_argument &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;/br&gt;
&lt;h3 id=&#34;other-references&#34;&gt;Other references&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/48748745/pattern-for-rich-error-handling-in-grpc&#34;&gt;Pattern for rich error handling in gRPC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://jbrandhorst.com/post/grpc-errors/&#34;&gt;Advanced gRPC Error Usage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Vehicle Service</title>
      <link>/velocitas-docs/docs/reference/val/vehicle_service/</link>
      <pubDate>Mon, 09 May 2022 14:24:56 +0530</pubDate>
      
      <guid>/velocitas-docs/docs/reference/val/vehicle_service/</guid>
      <description>
        
        
        &lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#how-to-create-a-vehicle-service&#34;&gt;How to create a vehicle service&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#motivation&#34;&gt;Motivation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#overview&#34;&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#define-a-service-interface&#34;&gt;Define a service interface&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#semantic-model&#34;&gt;Semantic model&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#interface-technology-and-programming-languages&#34;&gt;Interface technology and programming languages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#interface-guideline&#34;&gt;Interface guideline&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#error-codes&#34;&gt;Error codes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#implement-a-vehicle-service&#34;&gt;Implement a vehicle service&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#examples&#34;&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#responsibility&#34;&gt;Responsibility&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#connection-status&#34;&gt;Connection status&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#add-dapr-support-to-the-vehicle-service&#34;&gt;Add Dapr support to the vehicle service&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#metadata&#34;&gt;Metadata&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#connection-status-with-dapr&#34;&gt;Connection status with Dapr&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#interaction-with-the-vehicle-data-broker-optional&#34;&gt;Interaction with the vehicle data broker (optional)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;how-to-create-a-vehicle-service&#34;&gt;How to create a vehicle service&lt;/h1&gt;
&lt;h2 id=&#34;motivation&#34;&gt;Motivation&lt;/h2&gt;
&lt;p&gt;Vehicle services abstract complex behavior of the vehicle. They abstract the differences in electric and electronic architecture of vehicles from different brands and models to a common interface, which is aligned to a harmonized semantic model. A &lt;em&gt;Vehicle App&lt;/em&gt; developer interacts with the vehicle abstraction layer components via the SDK. The SDK and the VAL components are aligned via the interface description, which is derived from the semantic model.&lt;/p&gt;
&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;Following steps are needed to create a vehicle service:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Define a service interface&lt;/li&gt;
&lt;li&gt;Implement the service&lt;/li&gt;
&lt;li&gt;Add support for &lt;a href=&#34;https://dapr.io&#34;&gt;Dapr&lt;/a&gt; middleware&lt;/li&gt;
&lt;li&gt;(optional) Implement simulation&lt;/li&gt;
&lt;li&gt;(optional) Interaction with the vehicle data broker&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;define-a-service-interface&#34;&gt;Define a service interface&lt;/h2&gt;
&lt;h3 id=&#34;semantic-model&#34;&gt;Semantic model&lt;/h3&gt;
&lt;p&gt;The service interface of the vehicle service which abstracts the vehicle behavior, should be aligned to the semantic model. The &lt;a href=&#34;https://github.com/COVESA/vehicle_service_catalog&#34;&gt;VEHICLE SERVICE CATALOG&lt;/a&gt; can be used as the semantic model for a service call.&lt;/p&gt;
&lt;h3 id=&#34;interface-technology-and-programming-languages&#34;&gt;Interface technology and programming languages&lt;/h3&gt;
&lt;p&gt;The interface technology used for remote procedure calls is &lt;a href=&#34;https://grpc.io/&#34;&gt;gGRPC&lt;/a&gt;. The methods and datatypes are first defined in a *.proto file, which is then used to generate client and server stubs/skeletons in &lt;a href=&#34;https://grpc.io/docs/languages/&#34;&gt;different languages&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;How to use the interface and generate code can be read e.g., here: &lt;a href=&#34;https://grpc.io/docs/languages/cpp/basics/&#34;&gt;Basics tutorial for gRPC in C++&lt;/a&gt; or &lt;a href=&#34;https://grpc.io/docs/languages/python/basics/&#34;&gt;Basics tutorial for gRPC in Python&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;interface-guideline&#34;&gt;Interface guideline&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&#34;interface_guideline.md&#34;&gt;gRPC interface guideline&lt;/a&gt; provides you with help on how to specify the service interface.&lt;/p&gt;
&lt;h3 id=&#34;error-codes&#34;&gt;Error codes&lt;/h3&gt;
&lt;p&gt;The error codes and recommended usage is described in &lt;a href=&#34;/velocitas-docs/docs/val/interface_guideline/#error-handling&#34;&gt;Error Handling&lt;/a&gt;. The errors implemented should be described in the gRPC interface description files (*.proto).&lt;/p&gt;
&lt;h2 id=&#34;implement-a-vehicle-service&#34;&gt;Implement a vehicle service&lt;/h2&gt;
&lt;h3 id=&#34;examples&#34;&gt;Examples&lt;/h3&gt;
&lt;p&gt;For help on how to implement the vehicle service, see the example seat service or the &lt;a href=&#34;https://github.com/grpc/grpc/tree/master/examples&#34;&gt;gRPC examples&lt;/a&gt; in different languages.&lt;/p&gt;
&lt;h3 id=&#34;responsibility&#34;&gt;Responsibility&lt;/h3&gt;
&lt;p&gt;A vehicle service &amp;hellip;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Can provide service interfaces to control actuators or to trigger (complex) actions&lt;/li&gt;
&lt;li&gt;Can provide service interfaces to get data&lt;/li&gt;
&lt;li&gt;Uses service interfaces to register and publish data to the data broker&lt;/li&gt;
&lt;li&gt;Reconnects to the data broker in case the connection is lost&lt;/li&gt;
&lt;li&gt;Uses the service interface of the data broker via Dapr, if deployed&lt;/li&gt;
&lt;li&gt;Communicates with a vehicle network, which is connected to real hardware (e.g., CAN interface)&lt;/li&gt;
&lt;li&gt;Communicates with a virtual interface (e.g., CAN interface)&lt;/li&gt;
&lt;li&gt;(Optional) Provides a simulation mode to run without a network interface&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A vehicle service implementation ..&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;might be implemented vehicle- or project-specific&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;connection-status&#34;&gt;Connection status&lt;/h3&gt;
&lt;p&gt;To be able to detect connectivity problems users of a gRPC service, e.g., for &lt;a href=&#34;#interaction-with-the-vehicle-data-broker-optional&#34;&gt; feeding data to the data broker&lt;/a&gt;, shall preferably monitor the gRPC connection state, see: &lt;a href=&#34;https://grpc.github.io/grpc/core/md_doc_connectivity-semantics-and-api.html&#34;&gt;gRPC Connectivity Semantics and API &lt;/a&gt;.
This can be used to report or log errors if the connection behaves differently than expected.&lt;/p&gt;
&lt;h2 id=&#34;add-dapr-support-to-the-vehicle-service&#34;&gt;Add Dapr support to the vehicle service&lt;/h2&gt;
&lt;p&gt;You can use the gRPC proxying feature of Dapr, which allows you to use custom *.proto files/ interfaces instead of the predefined Dapr gRPC interfaces. More can be read at &lt;a href=&#34;https://docs.dapr.io/developing-applications/building-blocks/service-invocation/howto-invoke-services-grpc/&#34;&gt;How-To: Invoke services using gRPC&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To support Dapr within your vehicle service application ..&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the gRPC metadata &lt;code&gt;dapr-app-id&lt;/code&gt; of the server needs to be specified in the call&lt;/li&gt;
&lt;li&gt;the used gRPC port should be configurable at least via the environment variable, use &lt;code&gt;DAPR_GRPC_PORT&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A full reference to the Dapr environment variables can be found &lt;a href=&#34;https://docs.dapr.io/reference/environment/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;metadata&#34;&gt;Metadata&lt;/h3&gt;
&lt;p&gt;To call the methods of a gRPC server (e.g. register data points on the data broker) via Dapr the gRPC calls need to be extended with metadata.&lt;/p&gt;
&lt;p&gt;We recommend that you read the &lt;code&gt;dapr-app-id&lt;/code&gt; of the gRPC server either from the command line parameter, environment variable of configuration file instead of hardcoding it, see for Python:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000&#34;&gt;grpc_metadata&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;dapr-app-id&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;os&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;environ&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;get&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;VEHICLEDATABROKER_DAPR_APP_ID&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000&#34;&gt;channel&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;insecure_channel&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;databroker_address&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000&#34;&gt;channel&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;subscribe&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;...&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_provider&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;databroker&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Provider&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;channel&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc_metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This makes it possible to keep the resulting containerized application independent of the configuration and avoid unnecessary rebuilds.&lt;/p&gt;
&lt;h3 id=&#34;connection-status-with-dapr&#34;&gt;Connection status with Dapr&lt;/h3&gt;
&lt;p&gt;In a Dapr environment, evaluating the gRPC connectivity state as described in &lt;a href=&#34;#connection-status&#34;&gt;connection status&lt;/a&gt; is not sufficient. Since the vehicle service communicates via gRPC with the Dapr sidecar application instead with the Dapr server directly, the gRPC communication state is also related to the Dapr side car instead of the server. Additional measures need to be taken to check if the &amp;ldquo;real&amp;rdquo; server is available.
Dapr gRPC proxying is only allowed AFTER the Dapr sidecar is fully initialized. If an app port has been specified when running the Dapr sidecar, the sidecar verifies that the service is listening on the port first as part of the initialization.&lt;/p&gt;
&lt;p&gt;The following sequence in vehicle services is recommended:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create a gRPC Server and listen&lt;/li&gt;
&lt;li&gt;Wait for the sidecar (e.g., poll health endpoint or sleep )&lt;/li&gt;
&lt;li&gt;Execute gRPC proxying calls (e.g., against Vehicle Data Broker)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Example: A callback for the connectivity state in conjugation with retry to call the server:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000&#34;&gt;channel&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;insecure_channel&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;databroker_address&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000&#34;&gt;channel&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;subscribe&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;lambda&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;on_broker_connectivity_change&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#000&#34;&gt;try_to_connect&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;False&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;on_broker_connectivity_change&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ChannelConnectivity&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;READY&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;or&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ChannelConnectivity&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;IDLE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;## Can change between READY and IDLE. Only act if coming from&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;## unconnected state&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;not&lt;/span&gt; &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_connected&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;info&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Connected to data broker&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;try&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_register_datapoints&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_registered&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#c00;font-weight:bold&#34;&gt;Exception&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;error&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Failed to register datapoints&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;exc_info&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;True&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_connected&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;else&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_connected&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;info&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Disconnected from data broker&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;else&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;connectivity&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;grpc&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ChannelConnectivity&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;CONNECTING&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;info&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Trying to connect to data broker&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_connected&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#3465a4&#34;&gt;self&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;_registered&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If the Dapr side car is ready to forward, communication can be checked with the &lt;a href=&#34;https://grpc.github.io/grpc/core/md_doc_health-checking.html&#34;&gt;GRPC Health Checking Protocol &lt;/a&gt;, see also &lt;a href=&#34;https://grpc.github.io/grpc/python/grpc_health_checking.html&#34;&gt;Python gRPC Health Checking&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;interaction-with-the-vehicle-data-broker-optional&#34;&gt;Interaction with the vehicle data broker (optional)&lt;/h2&gt;
&lt;p&gt;Use the &lt;a href=&#34;https://github.com/eclipse/kuksa.val/tree/master/kuksa_databroker/proto&#34;&gt;interface description of the vehicle data broker (*.proto files)&lt;/a&gt; to publish data to the vehicle data broker. In the &lt;code&gt;collector.proto&lt;/code&gt; you find methods to&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;register datapoints &lt;code&gt;RegisterDatapoints&lt;/code&gt;, afterwards you can&lt;/li&gt;
&lt;li&gt;feed data via single calls &lt;code&gt;UpdateDatapoints&lt;/code&gt; or in a stream manner &lt;code&gt;StreamDatapoints&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;See the *.proto files for a detailed description.&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
